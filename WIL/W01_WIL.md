# CS:APP 1장 - 컴퓨터 시스템으로의 여행

---

## 1.1 정보는 비트와 컨텍스트로 이루어진다

- 프로그램은 *소스 프로그램*으로 작성된다 - 소스 프로그램은 0과 1의 *비트*의 연속이며, *바이트*라는 8비트 단위로 구성된다.
- 대부분의 컴퓨터 시스템은 텍스트 문자를 아스키(ASCII) 표준을 사용하여 표시한다 - 아스키 표준은 각 문자를 바이트 길이의 정수로 나타낸다.
- 아스키 문자로만 이루어진 파일은 *텍스트 파일*, 그 외의 파일은 *바이너리 파일*이라고 한다.
- 비트들로 표현된 객체를 구분은 그들을 바라보는 컨텍스트를 통해 할 수 있다.

---

## 1.2 프로그램은 다른 프로그램에 의해 다른 형태로 번역된다

- 프로그램이 실행되기 위해서는 저급 기계어 인스트럭션으로 번역되어야 한다.

- hello.c 소스 프로그램이 유닉스 시스템에서 번역되고 실행되는 과정 - 컴파일러 드라이버의 컴파일 시스템

| 단계명 | 대응 프로그램 | 출력 프로그램 |
| :---: | :---------: | :---------: |
| 전처리 | 전처리기 | 수정된 소스 프로그램(.i) |
| 컴파일 | 컴파일러 | 어셈블리어 프로그램(.s) |
| 어셈블리 | 어셈블러 | 목적파일(.o) |
| 링크 | 링커 프로그램 | 실행가능 목적파일 |

> - 전처리 단계
> 전처리기(cpp)는 #으로 시작되는 디렉티브에 따라 본래의 C 프로그램을 수정한다.
> - 컴파일 단계
> 컴파일러(cc1)는 .i 프로그램을 *어셈블리어 프로그램*으로 번역하여 .s의 형식으로 저장한다.
> - 어셈블리 단계
> 어셈블러(as)는 어셈블리어를 기계어 인스트럭션으로 번역하고, 이를 *재배치가능 목적프로그램*의 형태로 묶어 목적파일에 그 결과를 저장한다.
> - 링크 단계
> 링커 프로그램(ld)는 흩어진 목적파일을 통합하는 작업을 수행하여 그 결과를 *실행가능 목적파일*로 저장한다.

---

## 1.3 컴파일 시스템이 어떻게 동작하는지 이해하는 것은 중요하다

컴파일 시스템이 어떻게 동작하는지 이해해야 하는 이유

- 프로그램 성능 최적화하기
기계어 수준 코드에 대한 기본적인 이해를 갖고 컴파일러가 기계어 코드를 번역하는 과정을 알고 있으면 더 효율적인 프로그래밍이 가능하다.
- 링크 에러 이해하기
- 보안약점 피하기

---

## 1.4 프로세서는 메모리에 저장된 인스트럭션을 읽고 해석한다

- 시스템의 하드웨어 조직 - 프로세서

>- 버스
>시스템 내를 관통하는 전기 배선군으로, 컴포넌트간에 바이트 정보를 전송한다.
>일반적으로 *워드*라는 고정 크기의 바이트 단위로 데이터를 전송한다.
>- 입출력 장치
>시스템과 외부 세계와의 연결을 담당한다.
>예: 키보드, 마우스, 디스플레이, 디스크 드라이브 등
>- 메인 메모리
>프로세서가 프로그램을 실행하는 동안 데이터와 프로그램을 모두 저장하는 임시 저장장치이다.
>물리적으로는 DRAM 칩들로, 논리적으로는 고유의 주소를 가진 연속적인 바이트의 배열로 구성된다.
>- 프로세서
>주처리장치(CPU)라고도 불린다. 메인 메모리에 저장된 인스트럭션들을 해독/실행한다.
>프로세서는 워드 크기의 저장장치인 *레지스터*와 현재 실행중인 기계어 인스트럭션의 메인 메모리 주소를 가리키는 *프로그램 카운터*(PC), 레지스터로 부터 받은 값으로 연산을 하는 *수식 논리 처리기*(ALU)를 가지고 있다.

- CPU가 처리하는 작업의 예시

| 작업 |  |
| :---: | :---------- |
| 적재(load) | 메인메모리 > 레지스터로 데이터를 복사 |
| 저장(store) | 레지스터 > 메인메모리로 데이터를 복사 |
| 작업(operate) | 레지스터 > ALU 로 데이터를 복사하여 연산을 수행한 후 그 결과를 레지스터에 저장|
| 점프(jump) | 인스트럭션으로부터 워드를 추출하여 그 값을 PC에 복사 |

---

## 1.7 운영체제는 하드웨어를 관리한다

- 운영체제의 주요 목적

> 1. 제멋대로 동작하는 응용프로그램이 하드웨어를 오용하는 것을 방지하기
> 2. 응용프로그램이 단순한 매커니즘으로 하드웨어 장치를 조작할 수 있게 함

- 운영체제의 추상화
  - 프로세스
  실행중인 프로그램에 대한 추상화
  프로세스의 상태 정보는 *컨텍스트*라 하여 PC, 레지스터와 메인 메모리의 값 등을 포함한다.
  이전 프로세스의 컨텍스트를 저장하고 다음 프로세스의 컨텍스트를 복원시키는 *문맥 전환*을 통해 다수의 프로세스가 동시에 실행되고 있는 느낌을 줄 수 있다.
  프로세스로부터 다른 프로세스로의 전환은 운영체제의 *커널*에 의해 관리된다.
  - 스레드
  프로세스가 가진 다수의 실행 유닛
  해당 프로세스의 컨텍스트에서 실행되며 동일한 코드와 전역 데이터를 공유한다.
  - 가상메모리
  메인 메모리에 대한 추상화
  프로세스가 메인 메모리를 독점적으로 사용하고 있는 느낌을 줄 수 있다.
    - 가상메모리의 구조
      - 프로그램 코드와 데이터
      - 힙
      - 공유 라이브러리
      - 스택
      - 커널 가상메모리
  - 파일
  입출력장치에 대한 추상화
  모든 입출력장치는 파일로 모델링되며, 시스템의 입출력은 *유닉스 I/O* 시스템 콜을 이용하여 파일을 읽고 쓰는 형태로 이루어진다.
